<!-- 
$theme: gaia
template: invert
-->

Fastlane å…¥é–€
===

#### 2018/09/16 

#### ç¬¬28å› å²¡å±±ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªé–‹ç™ºã‚‚ãã‚‚ãä¼š

###### Created by é«˜æ©‹ ä¸€é¨ ( [@ikkitang](https://github.com/ikkitang) )

---

<!-- page_number: true -->

# ãŠã—ãªãŒã

---

# ãŠã—ãªãŒã

1. **ã‚ã°ã†ã¨ã¿ãƒ¼**
1. **Fastlaneã«ã¤ã„ã¦**ã€€
1. **ã¾ã¨ã‚**

---

# 1. ã‚ã°ã†ã¨ã¿ãƒ¼

## é«˜æ©‹ã€€ä¸€é¨ (_ takahashi ikki )

- å²¡å±±ã§Webã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
- PHPer ğŸ˜ ã€ Pythonista ğŸ ã€Swiftå¥½ã ğŸ£
- JPUGä¸­å›½æ”¯éƒ¨é•·
- Twitter @ikkitang 

---

<!-- prerender: true -->

# å©šæ´»ã¨ã„ãˆã°ã‚ªãƒŸã‚«ãƒ¬

## https://party-calendar.net/

![bg 65%](./img/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ%202018-09-09%2016.02.50.png)

---

<!-- prerender: true -->

## ä¸­å›½åœ°æ–¹DBå‹‰å¼·ä¼š in åºƒå³¶
### 2018/09/29 (åœŸ) 
### https://dbstudychugoku.connpass.com/event/94746/

### æ¥ã¦ãã‚Œï¼ é ¼ã‚€ã£ğŸ˜­

---

# 2. Fastlaneã«ã¤ã„ã¦

--- 

# ğŸ‰ iOSDC Japan 2018 ğŸ‰
#### https://iosdc.jp/2018/

![bg center 80%](./img//ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ%202018-09-09%2016.16.18.png)

--- 

# iOSDC Japan 2018

[ç´¹ä»‹Fastfile](https://speakerdeck.com/giginet/xiang-jie-fastfile)

### Fastfileã®æ›¸ãæ–¹ã«ã¤ã„ã¦ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®ç´¹ä»‹ã€‚

ã‚ã£ã¡ã‚ƒã‚ˆã‹ã£ãŸã€‚

çµè«–ï¼š Fastfileã‚’æ›¸ã‹ãªã„ï¼

---

## ãƒ“ãƒ«ãƒ‰è¨­å®šã®ãƒ™ã‚¹ãƒˆãƒ»ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
##### â€» ç´¹ä»‹Fastfileã‚ˆã‚Šå¼•ç”¨

![center 50%](./img/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ%202018-09-09%2021.49.31.png)


---

## æ˜¯éã€è¦‹ã¦ã»ã—ã„ï¼

---

# Fastlaneã«ã¤ã„ã¦

- [fastlane/fastlane](https://github.com/fastlane/fastlane)
  - Rubyè£½ã®ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼
  - å…¬å¼Doc: [https://docs.fastlane.tools/ ](https://docs.fastlane.tools/)
- fastlaneã¯ã€iOSã‚„Androidã‚¢ãƒ—ãƒªã®ãƒ™ãƒ¼ã‚¿ç‰ˆã®å°å…¥ã‚„ãƒªãƒªãƒ¼ã‚¹ã‚’è‡ªå‹•åŒ–ã™ã‚‹æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ã§ã™ã€‚ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®ç”Ÿæˆã€ã‚³ãƒ¼ãƒ‰ç½²åã®å‡¦ç†ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒªãƒªãƒ¼ã‚¹ãªã©ã€ã™ã¹ã¦ã®é¢å€’ãªä½œæ¥­ã‚’å‡¦ç†ã—ã¾ã™ã€‚

---

# ã‚¢ãƒ—ãƒªé–‹ç™ºã®è¾›ã¿

- ãƒ“ãƒ«ãƒ‰ã¨ã‹AppStoreã¸ã®ç”³è«‹ãŒå±äººåŒ–ã—ãŒã¡ã€‚
- ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã«ã¤ã„ã¦å¤‰æ›´ã®åº¦ã«ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã¨è©±ã—ãŸã‚Šé¢å€’ã€‚
- ã‚³ãƒ¼ãƒ‰ç½²åã®ç®¡ç†è¶…é¢å€’ãã•ã„ã€‚
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†é¢å€’ãã•ã„
  
### => ãã®è¾º Fastlane ã§è§£æ±ºå‡ºæ¥ã¾ã™ã‚ˆï¼Ÿ

---

# Fastlane ã®æ¦‚å¿µ

![center 80%](./img/lane_discription.png)

---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)

- Testing
- Building
- Screenshots
- Project
- Code Signing
- Beta
- Push
- Releasing your app
- etc...


---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)

###  ==Testing==

- scan
  - XCodeã®è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
- swiftlint
  - Swiftlintã‚’å®Ÿè¡Œã™ã‚‹
- appium
  - appium ã‚„ rspec ã‚’å®Ÿè¡Œã™ã‚‹

---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)

### ==building==

- gym ( build_ios_app )
  - ã‚¢ãƒ—ãƒªã®ãƒ“ãƒ«ãƒ‰ã‚’ã™ã‚‹
- cocoapods
  - `pod install` ã‚’å®Ÿè¡Œã™ã‚‹

---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)


### ==Screenshots==

- snapshot
  - UITestãŒå‹•ã„ã¦ã‚¹ã‚¯ã‚·ãƒ§ãŒæ’®ã‚Œã‚‹.
  - App Storeå…¬é–‹ç”¨ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®è‡ªå‹•åŒ–ã¨ã‹å‡ºæ¥ã‚‹ã€‚

### ==Project==

- increment_build_number
  - ãƒ“ãƒ«ãƒ‰ç•ªå·ã‚’è‡ªå‹•ã§ä¸Šã’ã‚‹

---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)

### ==Code Signing==

- sign ( get_provisioning_profile )
  - provisioning profile ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- cert ( get_certificates )
  - è¨¼æ˜æ›¸ã‚’ç”Ÿæˆã—ã¦keychainã«ç™»éŒ²ã™ã‚‹
- register_device ( register_devices )
  - iOSç«¯æœ«ã‚’ç™»éŒ²ã™ã‚‹

---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)

### ==Beta==

- ãƒ™ãƒ¼ã‚¿ç‰ˆã®é…ä¿¡ã‚’è¡Œã†äº‹ãŒå‡ºæ¥ã‚‹
  - å¯¾å¿œã‚µãƒ¼ãƒ“ã‚¹ç„¡é™ã«ã‚ã‚Šãã†
  - TestFlight / Crashlytics / DeployGate

### ==Push==

- pem ( get_push_certificate )
  - ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥è¨¼æ˜æ›¸ã‚’ç”Ÿæˆã™ã‚‹

---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)

### ==Releasing your app==

- deliver ( upload_to_app_store )
- supply ( upload_to_play_store )
  - å„å¯¾å¿œã®ã‚¢ãƒ—ãƒªãƒªãƒªãƒ¼ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ipa/apkã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

---

## Action ã®å¤§ã¾ã‹ãªåˆ†é¡(æŠœç²‹)

### ==ãã®ä»–==

- Notifications/slack 
  - slackã¸é€šçŸ¥ã™ã‚‹
  - ä»–ã«ã‚‚ chartwork/mailgunã¨ã‹ã‚ã‚‹
- App Store Connect/produce
  - æ–°è¦ã®AppStoreæ›´æ–°Versionã‚’ä½œæˆã™ã‚‹ã€‚

--- 

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

- bundlerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
$ gem install bundler
```

- Gemfileã‚’ç·¨é›†

```ruby
source "https://rubygems.org"
gem 'fastlane'
```

- fastlane ã‚’install

```
$ bundle install --path vendor/bundle
```

--- 

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- bundlerã‚’åˆæœŸã‚»ãƒƒãƒˆ

```
$ bundle exec fastlane init
```

- è³ªå•ç­”ãˆã¦ã„ã
  - ä»Šå›ã¯`App Storeã¸è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹`ã‚’é¸æŠã—ãŸã€‚
  - ã‚¢ãƒ—ãƒªã® identifier ã¨ã‹è¨­å®šã—ã¦ãŠãã¨ã€è‡ªå‹•ã§å–å¾—ã—ã¦ãã‚Œã‚‹
  - AppStoreã¸å…¬é–‹æ¸ˆã¿ã®ã‚¢ãƒ—ãƒªã«å¯¾ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨Screenshotç­‰ã‚‚è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚ŒãŸã€‚

--- 

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- bundlerã‚’åˆæœŸã‚»ãƒƒãƒˆ

```
$ bundle exec fastlane init
```

- è³ªå•ç­”ãˆã¦ã„ã
  - ä»Šå›ã¯`App Storeã¸è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹`ã‚’é¸æŠã—ãŸã€‚
  - ã‚¢ãƒ—ãƒªã® identifier ã¨ã‹è¨­å®šã—ã¦ãŠãã¨ã€è‡ªå‹•ã§å–å¾—ã—ã¦ãã‚Œã‚‹
  - AppStoreã¸å…¬é–‹æ¸ˆã¿ã®ã‚¢ãƒ—ãƒªã«å¯¾ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨Screenshotç­‰ã‚‚è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚ŒãŸã€‚

---


## Demo

<video controls="controls" width="900" height="500" style="background: #0F0F0F;">
  <source src="./demo/fastlane_demo_tests.mov">
</video>

--- 

## ã‚½ãƒ¼ã‚¹è§£èª¬

- Fastfileã«laneã‚’å®šç¾©

```ruby
lane :tests do
  run_tests(scheme:"QuickQRReaderTests")
end
```

- å®šç¾©ã—ãŸ lane `tests` ã‚’æŒ‡å®šã—ã¦ fastlane ã‚’å®Ÿè¡Œ

```
$ bundle exec fastlane tests
```

---

## ãã®ä»–

- Slackã«ãƒ†ã‚¹ãƒˆçµæœã‚’é€šçŸ¥ã™ã‚‹äº‹ã‚‚å¯èƒ½.

```ruby
lane :tests do
  run_tests(scheme:"QuickQRReaderTests",
            slack_url: "https://hooks.slack.com/xx..",
            slack_channel: "#general")
end
```

`bundle exec tests` â†“â†“

![70%](./img/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ%202018-09-15%2021.28.46.png)

--- 

# 3. ã¾ã¨ã‚

--- 

# 3. ã¾ã¨ã‚

- Fastlane ã‚’ä½¿ãˆã°å¤§æŠµã®äº‹ã¯è‡ªå‹•åŒ–ã§ãã‚‹ã€‚
- ãƒãƒ¼ãƒ é–‹ç™ºã«å°å…¥ã—ã¦Operationã®è‡ªå‹•åŒ–ã‚„ç°¡ç•¥åŒ–ã‚’å®Ÿç¾ã—ã¦ã„ã“ã†ï¼
- ä»Šå›ç´¹ä»‹ã—åˆ‡ã‚Œãªã‹ã£ãŸã‚³ãƒãƒ³ãƒ‰ã¯ã¾ãŸãƒ‡ãƒ¢ã—ãŸã„ã¨æ€ã„ã¾ã™ï¼